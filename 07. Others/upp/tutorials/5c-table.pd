#N canvas 25 41 555 714 10;
#X declare -path .. -path .;
#X obj 27 11 cnv 15 500 40 empty empty Universal_Polyphonic_Player
10 10 0 14 -233017 -66577 0;
#X text 34 34 playing notes with note-dependent timbre and decay;
#X text 406 100 to find voice patch;
#X text 411 14 grrrr.org \, 2012-15;
#X obj 379 79 declare -path .. -path .;
#X floatatom 68 162 5 0 0 1 MIDI_note - -, f 5;
#X obj 68 83 kbd;
#X obj 68 664 bng 15 250 50 0 empty empty overflow 17 7 0 10 -262144
-1 -1;
#X text 142 206 partials;
#N canvas 621 281 755 641 timbre+dur 0;
#X obj 90 28 inlet;
#X obj 83 590 outlet;
#N canvas 0 22 450 300 (subpatch) 0;
#X array timbre 150 float 1;
#A 0 89.107 89.3213 89.5356 89.7499 89.9642 89.9642 89.9642 90.3928
90.4642 90.5357 90.6071 90.8214 91.0357 91.0357 91.3571 91.6786 91.7322
91.7857 91.8393 91.8929 91.8929 91.8929 91.8929 91.8929 91.8929 91.8929
90.8214 90.6071 89.5356 88.8928 88.8928 88.8928 88.8928 89.2499 89.6071
89.9642 90.3214 90.6785 91.0357 91.25 91.4643 91.6786 91.8929 91.8929
91.8929 91.8929 91.8929 91.8929 91.8929 91.8929 91.8929 91.8929 92.1072
92.8215 93.5358 94.2501 95.5359 96.1788 97.2502 97.8931 97.8931 98.1074
98.4289 98.7503 99.1789 100.036 98.3217 94.2501 89.107 89.4285 89.7499
90.1785 90.6071 90.875 91.1428 91.4107 91.6786 92 92.3215 92.5358 92.9643
93.3929 93.8215 94.143 94.4644 94.893 95.1073 95.3216 95.643 96.1788
96.5359 96.8931 97.0359 94.2501 93.6072 90.8214 90.8214 91.25 91.6786
91.8929 92.1072 92.3215 92.5358 92.5358 92.9643 92.9643 92.9643 92.9643
92.9643 92.9643 92.9643 93.1786 93.3929 93.6072 93.8215 93.6072 92.7501
91.6786 89.9642 88.4642 88.0356 86.3212 85.8926 85.2497 84.6069 83.964
83.3211 82.8925 81.6067 80.8567 80.1067 79.4638 79.4638 79.4638 79.4638
79.4638 79.4638 79.4638 79.4638 79.4638 79.4638 79.4638 79.4638 79.4638
79.4638 79.4638 79.4638 78.8209 78.8209 79.0352;
#X coords 0 100 149 70 400 140 1;
#X restore 300 47 graph;
#X floatatom 53 137 5 0 0 0 - - -, f 5;
#X floatatom 171 135 5 0 0 0 - - -, f 5;
#X obj 54 247 until;
#X obj 54 203 f;
#X obj 53 224 t a b;
#X obj 52 280 f;
#X obj 86 279 + 1;
#X obj 67 167 t b a;
#X obj 84 328 *;
#X msg 108 249 1;
#X obj 116 500 dbtopow;
#X obj 91 61 unpack;
#X text 171 116 partials;
#X text 116 281 count partials;
#X text 49 346 partial frequencies;
#X text 229 478 fetch gain from table;
#X obj 53 94 mtof;
#X text 24 117 fundamental frq;
#X obj 83 372 ftom;
#N canvas 0 22 450 300 (subpatch) 0;
#X array decay 150 float 1;
#A 0 967.852 967.852 967.852 967.852 967.852 967.852 967.852 967.852
964.281 960.71 953.567 953.567 953.567 953.567 953.567 939.281 939.281
939.281 935.709 932.138 924.995 924.995 924.995 917.852 917.852 910.709
910.709 896.422 889.279 889.279 882.136 878.565 860.707 860.707 860.707
851.183 841.659 832.135 828.563 824.992 817.849 810.706 799.991 789.276
778.562 767.847 746.418 742.847 739.275 724.989 717.846 710.703 703.56
689.274 682.13 660.701 653.558 646.415 635.701 624.986 610.7 607.128
589.271 585.699 582.128 567.841 560.698 546.412 539.269 524.983 517.84
503.554 489.268 482.125 460.695 453.552 446.409 439.266 428.552 417.837
396.408 389.265 382.122 367.836 360.693 339.263 332.12 317.834 310.691
296.405 289.262 285.69 282.119 274.976 267.833 267.833 260.69 253.547
246.403 242.832 239.26 232.117 217.831 210.688 203.545 196.402 189.259
182.116 174.973 174.973 160.687 153.544 146.401 146.401 139.257 139.257
139.257 132.114 132.114 132.114 124.971 117.828 117.828 117.828 117.828
110.685 110.685 110.685 103.542 103.542 96.399 96.399 89.256 89.256
74.9698 74.9698 74.9698 67.8268 67.8268 60.6837 60.6837 60.6837 60.6837
60.6837 53.5406 53.5406 53.5406 53.5406 46.3976 46.3976;
#X coords 0 1000 149 0 400 140 1;
#X restore 300 205 graph;
#X obj 83 399 t a a a;
#X text 46 543 midinote volume attack decay;
#X obj 84 563 pack 0 0 20 0;
#X text 239 224 0..1000;
#X text 230 206 decay(ms);
#X text 239 38 gain(dB);
#X obj 116 477 tabread timbre;
#X msg 300 364 \; timbre const 80;
#X text 581 350 MIDI note 0...150;
#X obj 684 30 bng 15 250 50 0 empty empty clear -35 7 0 10 -204786
-1 -1;
#X msg 430 364 \; decay const 500;
#X obj 150 446 tabread decay;
#X text 270 445 fetch decay time from table;
#X text 243 56 70..100;
#X connect 0 0 14 0;
#X connect 3 0 10 0;
#X connect 4 0 6 1;
#X connect 5 0 8 0;
#X connect 6 0 7 0;
#X connect 7 0 5 0;
#X connect 7 1 12 0;
#X connect 8 0 9 0;
#X connect 8 0 11 0;
#X connect 9 0 8 1;
#X connect 10 0 6 0;
#X connect 10 1 11 1;
#X connect 11 0 21 0;
#X connect 12 0 8 1;
#X connect 13 0 25 1;
#X connect 14 0 19 0;
#X connect 14 1 4 0;
#X connect 19 0 3 0;
#X connect 21 0 23 0;
#X connect 23 0 25 0;
#X connect 23 1 29 0;
#X connect 23 2 34 0;
#X connect 25 0 1 0;
#X connect 29 0 13 0;
#X connect 32 0 30 0;
#X connect 32 0 33 0;
#X connect 34 0 25 3;
#X coords 0 -1 1 1 400 320 2 300 25;
#X restore 68 230 pd timbre+dur;
#X text 73 606 bus midinote volume attack decay;
#X obj 68 120 unpack;
#X obj 68 141 spigot;
#X floatatom 261 664 5 0 0 0 voices_active - -, f 5;
#X obj 365 643 out-mono;
#X obj 365 619 catch~ \$0-bus;
#X obj 68 565 list prepend \$0-bus;
#X obj 68 205 pack 0 15;
#X obj 68 624 upp.xf 100 note_busvoldur;
#X connect 5 0 17 0;
#X connect 6 0 11 0;
#X connect 9 0 16 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 5 0;
#X connect 15 0 14 0;
#X connect 16 0 18 0;
#X connect 17 0 9 0;
#X connect 18 0 7 0;
#X connect 18 2 13 0;
