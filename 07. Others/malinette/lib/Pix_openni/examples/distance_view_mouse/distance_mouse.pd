#N canvas 681 22 394 273 10;
#X obj 152 146 gemwin;
#N canvas 12 224 450 300 mouse 0;
#X floatatom 142 152 5 0 0 0 - - -;
#X floatatom 180 154 5 0 0 0 - - -;
#X obj 159 101 gemmouse 1 1;
#X obj 141 215 s /distance/mousecoord;
#X obj 141 181 pack f f;
#X connect 2 0 0 0;
#X connect 2 0 4 0;
#X connect 2 1 1 0;
#X connect 2 1 4 1;
#X connect 4 0 3 0;
#X restore 47 74 pd mouse;
#X msg 170 120 destroy;
#N canvas 519 271 526 490 text 0;
#X obj 137 -6 r /distance/meters;
#X obj 57 206 text3d;
#X obj 57 160 translateXYZ 0 0 0;
#X obj 1 49 gemhead 10;
#X obj 137 39 list append m;
#X obj 137 62 list trim;
#X floatatom 149 182 5 0 0 0 - - -;
#X obj 181 101 loadbang;
#N canvas 0 22 450 300 position 0;
#X obj 142 53 r /distance/mousecoord;
#X obj 142 75 unpack 0 0;
#X obj 199 102 - 0.5;
#X obj 199 184 outlet;
#X obj 142 103 - 0.5;
#X obj 142 185 outlet;
#X obj 142 129 * 9;
#X obj 199 157 + 0.2;
#X obj 199 128 * -7;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 2 0;
#X connect 2 0 8 0;
#X connect 4 0 6 0;
#X connect 6 0 5 0;
#X connect 7 0 3 0;
#X connect 8 0 7 0;
#X restore 92 122 pd position;
#X obj 1 76 color 1 1 1;
#X obj 311 160 translateXYZ 0 0 0;
#N canvas 0 22 450 300 position 0;
#X obj 142 53 r /distance/mousecoord;
#X obj 142 75 unpack 0 0;
#X obj 199 102 - 0.5;
#X obj 199 184 outlet;
#X obj 142 103 - 0.5;
#X obj 142 185 outlet;
#X obj 142 129 * 9;
#X obj 199 128 * -7;
#X obj 199 157 + 0.45;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 2 0;
#X connect 2 0 7 0;
#X connect 4 0 6 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 3 0;
#X restore 346 122 pd position;
#X obj 311 86 color 0 0 0 0.2;
#X obj 311 61 alpha;
#X obj 311 34 gemhead 9;
#X obj 137 18 list prepend text z:;
#X obj 74 439 text3d;
#X obj 74 393 translateXYZ 0 0 0;
#X obj 18 282 gemhead 10;
#X obj 94 312 list append m;
#X obj 94 335 list trim;
#X floatatom 166 415 5 0 0 0 - - -;
#X obj 198 334 loadbang;
#N canvas 0 22 450 300 position 0;
#X obj 142 53 r /distance/mousecoord;
#X obj 142 75 unpack 0 0;
#X obj 199 102 - 0.5;
#X obj 199 184 outlet;
#X obj 142 103 - 0.5;
#X obj 142 185 outlet;
#X obj 142 129 * 9;
#X obj 199 128 * -7;
#X obj 199 157 + 0.8;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 2 0;
#X connect 2 0 7 0;
#X connect 4 0 6 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 3 0;
#X restore 109 355 pd position;
#X obj 18 309 color 1 1 1;
#X obj 94 291 list prepend text x:;
#X obj 94 267 r /x/meters;
#X obj 323 434 text3d;
#X obj 323 388 translateXYZ 0 0 0;
#X obj 267 277 gemhead 10;
#X obj 343 307 list append m;
#X obj 343 330 list trim;
#X floatatom 415 410 5 0 0 0 - - -;
#X obj 447 329 loadbang;
#N canvas 0 22 450 300 position 0;
#X obj 142 53 r /distance/mousecoord;
#X obj 142 75 unpack 0 0;
#X obj 199 102 - 0.5;
#X obj 199 184 outlet;
#X obj 142 103 - 0.5;
#X obj 142 185 outlet;
#X obj 142 129 * 9;
#X obj 199 128 * -7;
#X obj 199 157 + 0.51;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 2 0;
#X connect 2 0 7 0;
#X connect 4 0 6 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 3 0;
#X restore 358 350 pd position;
#X obj 267 304 color 1 1 1;
#X obj 343 286 list prepend text y:;
#X obj 343 262 r /y/meters;
#X msg 198 392 4;
#X msg 447 387 4;
#X msg 181 159 4;
#X obj 311 202 rectangle 2 0.6;
#X connect 0 0 15 0;
#X connect 2 0 1 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 6 0 1 1;
#X connect 7 0 40 0;
#X connect 8 0 2 1;
#X connect 8 1 2 2;
#X connect 9 0 2 0;
#X connect 10 0 41 0;
#X connect 11 0 10 1;
#X connect 11 1 10 2;
#X connect 12 0 10 0;
#X connect 13 0 12 0;
#X connect 14 0 13 0;
#X connect 15 0 4 0;
#X connect 17 0 16 0;
#X connect 18 0 24 0;
#X connect 19 0 20 0;
#X connect 20 0 16 0;
#X connect 21 0 16 1;
#X connect 22 0 38 0;
#X connect 23 0 17 1;
#X connect 23 1 17 2;
#X connect 24 0 17 0;
#X connect 25 0 19 0;
#X connect 26 0 25 0;
#X connect 28 0 27 0;
#X connect 29 0 35 0;
#X connect 30 0 31 0;
#X connect 31 0 27 0;
#X connect 32 0 27 1;
#X connect 33 0 39 0;
#X connect 34 0 28 1;
#X connect 34 1 28 2;
#X connect 35 0 28 0;
#X connect 36 0 30 0;
#X connect 37 0 36 0;
#X connect 38 0 16 1;
#X connect 39 0 27 1;
#X connect 40 0 1 1;
#X restore 52 97 pd text;
#X msg 152 98 FSAA 4 \, dimen 640 480 \, create \, 1;
#N canvas 524 424 635 336 kinect 1;
#N canvas 555 258 725 506 distance_measurement 0;
#X obj 112 42 inlet;
#X obj 97 89 pix_data;
#X obj 119 140 unpack 0 0 0;
#X floatatom 121 162 5 0 0 0 - - -;
#X floatatom 160 162 5 0 0 0 - - -;
#X floatatom 200 162 5 0 0 0 - - -;
#X obj 153 201 * 256;
#X obj 83 201 * 65536;
#X obj 83 231 +;
#X text 112 231 rawdisparity 16 bit;
#X obj 454 127 expr 100/(-0.0030711016*$f1+3.3309495161);
#X obj 22 47 metro 100;
#X obj 22 24 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1 1
;
#X obj 454 155 / 100;
#X obj 83 350 nbx 5 60 -1e+37 1e+37 0 0 empty empty m 300 22 0 60 -262144
-1 -1 0 256;
#X text 229 101 output pixel rgb value;
#X text 230 9 for distance measurement use raw depth output!;
#X text 201 139 r g b;
#X text 192 200 second and first 8 bits;
#X text 396 26 -> see properties;
#X text 508 160 (mailinglist libfreenect);
#X text 165 326 display distance in meters;
#X text 240 52 x \, y pixel position in range 0 - 1;
#X text 507 144 distance in cm - empiric formula;
#X text 339 64 (from depth image);
#X text 40 23 ON/OFF;
#X obj 23 421 s /distance/meters;
#X obj 22 3 r /distance/poll;
#X obj 160 3 r /distance/mousecoord;
#X obj 160 26 unpack 0 0;
#X obj 217 46 - 1;
#X obj 217 70 * -1;
#X floatatom 454 180 5 0 0 0 - - -;
#X text 453 110 not so accurate formula;
#X obj 82 276 / 1000;
#X obj 464 230 expr 0.1236*tan($f1/2842.5+1.1863);
#X text 540 247 more accurate formula;
#X text 166 272 with new depth_mode 4;
#N canvas 144 26 622 390 x_y 0;
#X obj 32 12 r /distance/mousecoord;
#X obj 32 41 unpack 0 0;
#X obj 200 15 r /distance/mm;
#X floatatom 32 111 5 0 0 0 - - -;
#X obj 32 67 - 0.5;
#X obj 32 88 * 640;
#X floatatom 89 111 5 0 0 0 - - -;
#X obj 89 67 - 0.5;
#X text 100 42 x \, y;
#X obj 18 190 / 1000;
#X floatatom 18 214 5 0 0 0 - - -;
#X obj 18 156 expr ($f1/320)*$f2*tan(1.0144686707507438/2)*2;
#X text 328 242 X_rw=(X_proj/Xres-.5)*Z*XtoZ Y_rw=(0.5-Y_proj/Yres)*Z*YtoZ
\, where: XtoZ=tan(FovH/2)*2 YtoZ=tan(FovV/2)*2 FovH=1.0144686707507438
(rad) FovV=0.78980943449644714 (rad);
#X obj 318 156 expr ($f1/240)*$f2*tan(0.78980943449644714/2)*2;
#X obj 318 183 / 1000;
#X floatatom 318 207 5 0 0 0 - - -;
#X obj 89 88 * -480;
#X text 11 348 http://groups.google.com/group/openkinect/browse_thread/thread/1aa68954907a9f5d/d9d823b43f8eabef?lnk=gst&q=x+and+y+real+world#d9d823b43f8eabef
;
#X obj 376 204 s /y/meters;
#X obj 130 225 s /x/meters;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 7 0;
#X connect 2 0 11 1;
#X connect 2 0 13 1;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 5 0 11 0;
#X connect 7 0 16 0;
#X connect 9 0 10 0;
#X connect 9 0 19 0;
#X connect 11 0 9 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 14 0 18 0;
#X connect 16 0 6 0;
#X connect 16 0 13 0;
#X restore 503 362 pd x_y;
#X obj 149 256 s /distance/mm;
#X text 500 341 get X/Y real world coordinates;
#X connect 0 0 1 1;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 2 0 7 0;
#X connect 2 1 4 0;
#X connect 2 1 6 0;
#X connect 2 2 5 0;
#X connect 6 0 8 1;
#X connect 7 0 8 0;
#X connect 8 0 34 0;
#X connect 8 0 39 0;
#X connect 10 0 13 0;
#X connect 11 0 1 0;
#X connect 12 0 11 0;
#X connect 13 0 32 0;
#X connect 27 0 12 0;
#X connect 28 0 29 0;
#X connect 29 0 1 2;
#X connect 29 1 30 0;
#X connect 30 0 31 0;
#X connect 31 0 1 3;
#X connect 34 0 14 0;
#X connect 34 0 26 0;
#X restore 240 251 pd distance_measurement;
#X obj 240 174 pix_texture;
#X obj 240 226 rectangle 6.4 4.8;
#X obj 289 201 * 6.4;
#X obj 339 202 * 4.8;
#X floatatom 339 181 5 0 0 0 - - -;
#X msg 339 159 0.833;
#X obj 339 140 loadbang;
#X msg 62 11 angle \$1;
#X floatatom 62 -13 5 0 0 0 - - -;
#X msg 373 68 led 2;
#X msg 142 -6 depth_output 2;
#X obj 11 151 pix_texture;
#X obj 11 236 rectangle 6.4 4.8;
#X obj 60 211 * 6.4;
#X obj 110 212 * 4.8;
#X floatatom 110 191 5 0 0 0 - - -;
#X msg 110 169 0.833;
#X obj 110 150 loadbang;
#X obj 240 152 pix_alpha;
#X floatatom 255 125 5 0 0 0 - - -;
#X obj 364 19 alpha;
#X msg 246 15 rgb \$1;
#X msg 303 17 depth \$1;
#X obj 246 -6 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 303 -6 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 179 91 alpha;
#X obj 179 67 gemhead 3;
#X obj -10 72 gemhead 1;
#X msg 255 104 0.6;
#X msg 297 106 1;
#X msg 136 29 depth_output 0;
#X obj 441 49 route 1;
#X obj 443 18 route gem_state;
#X obj 441 80 delay 500;
#X msg 40 37 depth_mode 4;
#X obj 62 121 pix_openni 0 1 1;
#X msg 441 118 registration 1;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 3 0 2 1;
#X connect 4 0 2 2;
#X connect 5 0 4 0;
#X connect 5 0 3 0;
#X connect 6 0 5 0;
#X connect 7 0 6 0;
#X connect 7 0 29 0;
#X connect 8 0 36 0;
#X connect 9 0 8 0;
#X connect 10 0 36 0;
#X connect 11 0 36 0;
#X connect 12 0 13 0;
#X connect 14 0 13 1;
#X connect 15 0 13 2;
#X connect 16 0 15 0;
#X connect 16 0 14 0;
#X connect 17 0 16 0;
#X connect 18 0 17 0;
#X connect 19 0 1 0;
#X connect 20 0 19 1;
#X connect 20 0 19 2;
#X connect 22 0 36 0;
#X connect 23 0 36 0;
#X connect 24 0 22 0;
#X connect 25 0 23 0;
#X connect 26 0 36 1;
#X connect 27 0 26 0;
#X connect 27 0 33 0;
#X connect 28 0 36 0;
#X connect 29 0 20 0;
#X connect 30 0 20 0;
#X connect 31 0 36 0;
#X connect 32 0 34 0;
#X connect 33 0 32 0;
#X connect 34 0 10 0;
#X connect 34 0 11 0;
#X connect 34 0 35 0;
#X connect 34 0 37 0;
#X connect 35 0 36 0;
#X connect 36 0 12 0;
#X connect 36 1 19 0;
#X connect 37 0 36 0;
#X restore 40 122 pd kinect;
#X obj 40 189 tgl 15 0 /distance/poll /distance/poll activate 17 7
0 10 -262144 -1 -1 1 1;
#X text 19 13 display distance in depth image;
#X text 21 29 with mouse pointer;
#X obj 36 156 loadbang;
#X text 36 245 (C) 2011/12 Matthias Kronlachner;
#X connect 2 0 0 0;
#X connect 4 0 0 0;
#X connect 9 0 6 0;
