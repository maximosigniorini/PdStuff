#N canvas 147 345 652 338 10;
#N canvas 170 92 1010 734 FFT-reblocking 0;
#X obj 687 596 *~;
#X obj 288 400 rfft~;
#X obj 171 209 rfft~;
#X obj 448 592 rifft~;
#X obj 687 625 outlet~;
#X obj 735 89 block~;
#X obj 687 522 *~;
#X msg 735 64 set \$1 4;
#X obj 130 125 /~;
#X obj 46 124 /~;
#X obj 46 428 /~;
#X obj 148 427 /~;
#X obj 729 548 t b f;
#X msg 729 571 2;
#X obj 729 594 /;
#X obj 775 576 * 3;
#N canvas 697 91 270 255 get-mag 0;
#X obj 69 22 inlet~;
#X obj 162 107 *~;
#X obj 69 107 *~;
#X obj 69 133 +~;
#X obj 69 157 sqrt~;
#X obj 162 22 inlet~;
#X obj 69 203 outlet~;
#X connect 0 0 2 0;
#X connect 0 0 2 1;
#X connect 1 0 3 1;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 1 0;
#X connect 5 0 1 1;
#X restore 166 379 pd get-mag;
#N canvas 697 91 270 255 get-mag 0;
#X obj 69 22 inlet~;
#X obj 142 67 *~;
#X obj 69 67 *~;
#X obj 69 93 +~;
#X obj 69 117 sqrt~;
#X obj 142 22 inlet~;
#X obj 69 140 +~ 1e-20;
#X obj 69 163 outlet~;
#X connect 0 0 2 0;
#X connect 0 0 2 1;
#X connect 1 0 3 1;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 1 0;
#X connect 5 0 1 1;
#X connect 6 0 7 0;
#X restore 151 83 pd get-mag;
#X text 511 592 <-- inverse FFT;
#X obj 46 315 +~ 1e-15;
#X obj 208 235 *~ -1;
#N canvas 296 54 815 371 complex-mult 0;
#X obj 420 184 *~;
#X obj 384 184 *~;
#X obj 331 184 *~;
#X obj 300 184 *~;
#X obj 300 220 -~;
#X obj 384 217 +~;
#X obj 300 258 outlet~;
#X obj 384 258 outlet~;
#X obj 300 68 inlet~;
#X obj 384 68 inlet~;
#X obj 470 68 inlet~;
#X obj 554 68 inlet~;
#X text 211 293 Real result;
#X text 444 293 Imaginary result;
#X text 20 198 (Real1 * Real2) - (Imag1 * Imag2);
#X text 50 230 MINUS \, because i*i = -1;
#X text 470 198 (Imag1 * Real2) + (Real1 * Imag2);
#X text 488 34 Second multiplicand: real/imaginary;
#X text 170 34 First multiplicand: real/imaginary;
#X connect 0 0 5 1;
#X connect 1 0 5 0;
#X connect 2 0 4 1;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 7 0;
#X connect 8 0 3 0;
#X connect 8 0 0 0;
#X connect 9 0 2 0;
#X connect 9 0 1 0;
#X connect 10 0 3 1;
#X connect 10 0 1 1;
#X connect 11 0 2 1;
#X connect 11 0 0 1;
#X restore 46 290 pd complex-mult;
#N canvas 296 54 793 368 complex-mult 0;
#X obj 415 169 *~;
#X obj 379 169 *~;
#X obj 326 169 *~;
#X obj 295 169 *~;
#X obj 295 205 -~;
#X obj 379 202 +~;
#X obj 295 243 outlet~;
#X obj 379 243 outlet~;
#X obj 295 53 inlet~;
#X obj 379 53 inlet~;
#X obj 465 53 inlet~;
#X obj 549 53 inlet~;
#X text 206 278 Real result;
#X text 439 278 Imaginary result;
#X text 15 183 (Real1 * Real2) - (Imag1 * Imag2);
#X text 45 215 MINUS \, because i*i = -1;
#X text 465 183 (Imag1 * Real2) + (Real1 * Imag2);
#X text 483 19 Second multiplicand: real/imaginary;
#X text 165 19 First multiplicand: real/imaginary;
#X connect 0 0 5 1;
#X connect 1 0 5 0;
#X connect 2 0 4 1;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 7 0;
#X connect 8 0 3 0;
#X connect 8 0 0 0;
#X connect 9 0 2 0;
#X connect 9 0 1 0;
#X connect 10 0 3 1;
#X connect 10 0 1 1;
#X connect 11 0 2 1;
#X connect 11 0 0 1;
#X restore 46 520 pd complex-mult;
#X text 180 283 <-- complex multiplication: normalized previous times
the conjugate of the back window.;
#X text 261 230 <-- flip the sign of the imaginary component to get
the conjugate;
#N canvas 818 79 566 495 hann-window 0;
#X obj 41 81 until;
#X obj 41 132 f;
#X obj 81 132 + 1;
#X obj 82 222 f 6.2832;
#X obj 82 297 cos;
#X obj 82 270 *;
#X obj 41 367 * 0.5;
#X obj 41 163 t b b f f;
#X msg 62 106 0;
#X obj 41 343 -;
#X msg 41 270 1;
#X obj 311 329 table \$0-streamstretch-hann;
#X obj 41 388 tabwrite \$0-streamstretch-hann;
#X obj 41 21 r \$0-streamstretch-window-size;
#X msg 174 138 \; \$2-streamstretch-hann resize \$1 \;;
#X obj 174 115 pack f \$0;
#X obj 41 51 t f b f f;
#X obj 168 222 /;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 7 0;
#X connect 2 0 1 1;
#X connect 3 0 5 0;
#X connect 4 0 9 1;
#X connect 5 0 4 0;
#X connect 6 0 12 0;
#X connect 7 0 10 0;
#X connect 7 1 3 0;
#X connect 7 2 17 0;
#X connect 7 3 12 1;
#X connect 8 0 1 1;
#X connect 9 0 6 0;
#X connect 10 0 9 0;
#X connect 13 0 16 0;
#X connect 15 0 14 0;
#X connect 16 0 0 0;
#X connect 16 1 8 0;
#X connect 16 2 17 1;
#X connect 16 3 15 0;
#X connect 17 0 5 1;
#X restore 625 435 pd hann-window;
#N canvas 273 31 766 693 read-windows 0;
#X text 106 30 It may be ugly \, but better to patch the output directly
than a throw~/catch~ scenario \, since the latter causes an extra delay
of 1 block.;
#X obj 74 547 outlet~;
#X obj 369 579 outlet~;
#X obj 34 176 streamstretch-reader-abs \$0 0;
#X obj 45 206 streamstretch-reader-abs \$0 1;
#X obj 54 236 streamstretch-reader-abs \$0 2;
#X obj 64 266 streamstretch-reader-abs \$0 3;
#X obj 74 296 streamstretch-reader-abs \$0 4;
#X obj 84 326 streamstretch-reader-abs \$0 5;
#X obj 94 356 streamstretch-reader-abs \$0 6;
#X obj 104 386 streamstretch-reader-abs \$0 7;
#X obj 114 416 streamstretch-reader-abs \$0 8;
#X obj 124 446 streamstretch-reader-abs \$0 9;
#X obj 340 186 streamstretch-reader-abs \$0 10;
#X obj 351 216 streamstretch-reader-abs \$0 11;
#X obj 360 246 streamstretch-reader-abs \$0 12;
#X obj 370 276 streamstretch-reader-abs \$0 13;
#X obj 380 306 streamstretch-reader-abs \$0 14;
#X obj 390 336 streamstretch-reader-abs \$0 15;
#X obj 400 366 streamstretch-reader-abs \$0 16;
#X obj 410 396 streamstretch-reader-abs \$0 17;
#X obj 420 426 streamstretch-reader-abs \$0 18;
#X obj 430 456 streamstretch-reader-abs \$0 19;
#X connect 3 0 1 0;
#X connect 3 1 2 0;
#X connect 4 0 1 0;
#X connect 4 1 2 0;
#X connect 5 0 1 0;
#X connect 5 1 2 0;
#X connect 6 0 1 0;
#X connect 6 1 2 0;
#X connect 7 0 1 0;
#X connect 7 1 2 0;
#X connect 8 0 1 0;
#X connect 8 1 2 0;
#X connect 9 0 1 0;
#X connect 9 1 2 0;
#X connect 10 0 1 0;
#X connect 10 1 2 0;
#X connect 11 0 1 0;
#X connect 11 1 2 0;
#X connect 12 0 1 0;
#X connect 12 1 2 0;
#X connect 13 0 1 0;
#X connect 13 1 2 0;
#X connect 14 0 1 0;
#X connect 14 1 2 0;
#X connect 15 0 1 0;
#X connect 15 1 2 0;
#X connect 16 0 1 0;
#X connect 16 1 2 0;
#X connect 17 0 1 0;
#X connect 17 1 2 0;
#X connect 18 0 1 0;
#X connect 18 1 2 0;
#X connect 19 0 1 0;
#X connect 19 1 2 0;
#X connect 20 0 1 0;
#X connect 20 1 2 0;
#X connect 21 0 1 0;
#X connect 21 1 2 0;
#X connect 22 0 1 0;
#X connect 22 1 2 0;
#X restore 171 175 pd read-windows;
#X obj 131 38 tabreceive~ \$0-streamstretch-prev-imag;
#X obj 735 40 r \$0-streamstretch-window-size;
#X obj 625 359 table \$0-streamstretch-prev-real;
#X obj 625 379 table \$0-streamstretch-prev-imag;
#X obj 708 497 tabreceive~ \$0-streamstretch-hann;
#X obj 729 525 r \$0-streamstretch-window-size;
#X obj 172 594 tabsend~ \$0-streamstretch-prev-imag;
#X obj 32 623 tabsend~ \$0-streamstretch-prev-real;
#X obj 46 7 tabreceive~ \$0-streamstretch-prev-real;
#X obj 642 93 pack f \$0;
#X msg 642 113 \; \$2-streamstretch-prev-real resize \$1 \; \$2-streamstretch-prev-imag
resize \$1 \;;
#X connect 0 0 4 0;
#X connect 1 0 22 2;
#X connect 1 1 22 3;
#X connect 2 0 21 2;
#X connect 2 1 20 0;
#X connect 3 0 6 0;
#X connect 6 0 0 0;
#X connect 7 0 5 0;
#X connect 8 0 21 1;
#X connect 9 0 21 0;
#X connect 10 0 22 0;
#X connect 11 0 22 1;
#X connect 12 0 13 0;
#X connect 12 1 15 0;
#X connect 13 0 14 0;
#X connect 14 0 0 1;
#X connect 15 0 14 1;
#X connect 16 0 10 1;
#X connect 16 0 11 1;
#X connect 17 0 8 1;
#X connect 17 0 9 1;
#X connect 19 0 16 0;
#X connect 19 0 10 0;
#X connect 20 0 21 3;
#X connect 21 0 19 0;
#X connect 21 1 16 1;
#X connect 21 1 11 0;
#X connect 22 0 3 0;
#X connect 22 0 34 0;
#X connect 22 1 3 1;
#X connect 22 1 33 0;
#X connect 26 0 2 0;
#X connect 26 1 1 0;
#X connect 27 0 8 0;
#X connect 27 0 17 1;
#X connect 28 0 7 0;
#X connect 28 0 36 0;
#X connect 31 0 6 1;
#X connect 32 0 12 0;
#X connect 35 0 9 0;
#X connect 35 0 17 0;
#X connect 36 0 37 0;
#X restore 38 118 pd FFT-reblocking;
#X obj 38 170 outlet~;
#N canvas 308 317 726 434 input-buffering 0;
#X obj 33 86 bang~;
#X obj 40 201 f;
#X obj 103 181 + 64;
#X obj 40 152 spigot;
#X obj 40 276 f;
#X obj 102 265 + 1;
#X obj 40 223 select 0;
#X obj 103 203 % 44160;
#X text 169 192 Wait a certain number of blocks (690 here \, or about
a second) before recording to a new table;
#N canvas 438 88 674 430 buffer-tables 0;
#X obj 35 62 table \$0-streamstretch-buf-1 440960;
#X obj 35 92 table \$0-streamstretch-buf-2 440960;
#X obj 35 122 table \$0-streamstretch-buf-3 440960;
#X obj 35 152 table \$0-streamstretch-buf-4 440960;
#X obj 35 182 table \$0-streamstretch-buf-5 440960;
#X obj 35 212 table \$0-streamstretch-buf-6 440960;
#X obj 35 242 table \$0-streamstretch-buf-7 440960;
#X obj 35 272 table \$0-streamstretch-buf-8 440960;
#X obj 35 302 table \$0-streamstretch-buf-9 440960;
#X obj 35 32 table \$0-streamstretch-buf-0 440960;
#X obj 325 32 table \$0-streamstretch-buf-10 440960;
#X obj 325 62 table \$0-streamstretch-buf-11 440960;
#X obj 325 92 table \$0-streamstretch-buf-12 440960;
#X obj 325 122 table \$0-streamstretch-buf-13 440960;
#X obj 325 152 table \$0-streamstretch-buf-14 440960;
#X obj 325 182 table \$0-streamstretch-buf-15 440960;
#X obj 325 212 table \$0-streamstretch-buf-16 440960;
#X obj 325 242 table \$0-streamstretch-buf-17 440960;
#X obj 325 272 table \$0-streamstretch-buf-18 440960;
#X obj 325 302 table \$0-streamstretch-buf-19 440960;
#X restore 351 92 pd buffer-tables;
#X text 227 43 buffer length is just shy of 10 seconds. it's a multiple
of 64 so that block size will fit perfectly at wrap around.;
#N canvas 460 162 763 440 buffer-writing 0;
#X obj 21 29 streamstretch-buf-writer-abs \$0 0;
#X obj 301 299 streamstretch-buf-writer-abs \$0 19;
#X obj 301 149 streamstretch-buf-writer-abs \$0 14;
#X obj 21 59 streamstretch-buf-writer-abs \$0 1;
#X obj 21 89 streamstretch-buf-writer-abs \$0 2;
#X obj 21 119 streamstretch-buf-writer-abs \$0 3;
#X obj 21 149 streamstretch-buf-writer-abs \$0 4;
#X obj 21 179 streamstretch-buf-writer-abs \$0 5;
#X obj 21 209 streamstretch-buf-writer-abs \$0 6;
#X obj 21 239 streamstretch-buf-writer-abs \$0 7;
#X obj 21 269 streamstretch-buf-writer-abs \$0 8;
#X obj 21 299 streamstretch-buf-writer-abs \$0 9;
#X obj 301 29 streamstretch-buf-writer-abs \$0 10;
#X obj 301 59 streamstretch-buf-writer-abs \$0 11;
#X obj 301 89 streamstretch-buf-writer-abs \$0 12;
#X obj 301 119 streamstretch-buf-writer-abs \$0 13;
#X obj 301 179 streamstretch-buf-writer-abs \$0 15;
#X obj 301 209 streamstretch-buf-writer-abs \$0 16;
#X obj 301 239 streamstretch-buf-writer-abs \$0 17;
#X obj 301 269 streamstretch-buf-writer-abs \$0 18;
#X restore 351 122 pd buffer-writing;
#X obj 102 287 % 20;
#X obj 77 112 r \$0-streamstretch-buffer-rec-switch;
#X obj 40 356 s \$0-streamstretch-current-write-buf;
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 1 0 6 0;
#X connect 2 0 7 0;
#X connect 3 0 1 0;
#X connect 4 0 5 0;
#X connect 4 0 14 0;
#X connect 5 0 12 0;
#X connect 6 0 4 0;
#X connect 7 0 1 1;
#X connect 12 0 4 1;
#X connect 13 0 3 1;
#X restore 278 125 pd input-buffering;
#N canvas 50 77 891 688 trigger-playback 0;
#X obj 101 221 t b b b b b;
#X obj 101 284 f;
#X obj 138 266 + 1;
#X obj 238 455 - 1;
#X text 300 466 read from 1 buffer behind the one currently being written
into;
#X obj 238 477 moses 0;
#X obj 238 521 f;
#X obj 140 294 % 20;
#X msg 238 499 19;
#X text 176 625 pitch \, amp \, buftable \, speed pct;
#X obj 101 124 random 100;
#X obj 101 168 t b;
#X obj 218 302 + 25;
#X obj 101 146 moses 70;
#X obj 217 278 random 70;
#X obj 299 258 -;
#X obj 329 298 t b f;
#X obj 299 280 + 1;
#X obj 527 325 -;
#X obj 436 340 + -600;
#X obj 435 316 random 1200;
#X obj 556 364 t b f;
#X obj 527 348 + 1;
#X obj 101 102 metro 500;
#X obj 238 433 r \$0-streamstretch-current-write-buf;
#X obj 194 188 r \$0-streamstretch-manual-trig;
#X obj 101 450 pack f f f f \$0;
#X msg 101 572 \; \$5-streamstretch-reader-trig-\$1 \$3 100 \$5-streamstretch-buf-\$4 \$2
\;;
#N canvas 56 53 450 300 get-speed-range 0;
#X obj 130 117 unpack f f;
#X obj 73 75 t l l;
#X obj 42 116 unpack f f;
#X obj 42 138 max;
#X obj 130 139 min;
#X obj 42 160 outlet;
#X obj 131 163 outlet;
#X obj 80 49 r \$0-streamstretch-speed-range;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 1 0 2 0;
#X connect 1 1 0 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 3 0 5 0;
#X connect 4 0 6 0;
#X connect 7 0 1 0;
#X restore 299 232 pd get-speed-range;
#N canvas 56 53 450 300 get-transpo-range 0;
#X obj 130 117 unpack f f;
#X obj 73 75 t l l;
#X obj 42 116 unpack f f;
#X obj 42 138 max;
#X obj 130 139 min;
#X obj 42 160 outlet;
#X obj 131 163 outlet;
#X obj 80 49 r \$0-streamstretch-transpo-range;
#X connect 0 0 4 0;
#X connect 0 1 4 1;
#X connect 1 0 2 0;
#X connect 1 1 0 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 3 0 5 0;
#X connect 4 0 6 0;
#X connect 7 0 1 0;
#X restore 527 293 pd get-transpo-range;
#X obj 101 62 r \$0-streamstretch-auto-trig-switch;
#X obj 141 82 r \$0-streamstretch-auto-trig-rate;
#X obj 164 148 r \$0-streamstretch-auto-trig-prob;
#X connect 0 0 1 0;
#X connect 0 2 14 0;
#X connect 0 4 20 0;
#X connect 1 0 2 0;
#X connect 1 0 26 0;
#X connect 2 0 7 0;
#X connect 3 0 5 0;
#X connect 5 0 8 0;
#X connect 5 1 6 0;
#X connect 6 0 26 3;
#X connect 7 0 1 1;
#X connect 8 0 6 0;
#X connect 10 0 13 0;
#X connect 11 0 0 0;
#X connect 12 0 26 1;
#X connect 13 0 11 0;
#X connect 14 0 12 0;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 16 1 15 1;
#X connect 16 1 12 1;
#X connect 17 0 14 1;
#X connect 18 0 22 0;
#X connect 19 0 26 2;
#X connect 20 0 19 0;
#X connect 21 0 18 0;
#X connect 21 1 18 1;
#X connect 21 1 19 1;
#X connect 22 0 20 1;
#X connect 23 0 10 0;
#X connect 24 0 3 0;
#X connect 25 0 0 0;
#X connect 26 0 27 0;
#X connect 28 0 15 0;
#X connect 28 1 16 0;
#X connect 29 0 18 0;
#X connect 29 1 21 0;
#X connect 30 0 23 0;
#X connect 31 0 23 1;
#X connect 32 0 13 1;
#X restore 278 145 pd trigger-playback;
#X obj 38 17 inlet~;
#X obj 38 39 s~ \$0-streamstretch-input-sig;
#N canvas 33 54 553 280 init 0;
#X obj 71 36 loadbang;
#X obj 71 58 f \$0;
#X msg 71 89 \; \$1-streamstretch-samp-len 440960 \;;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X restore 278 105 pd init;
#X obj 439 26 inlet;
#N canvas 281 87 938 424 command-parsing 0;
#X obj 47 -25 inlet;
#X obj 47 78 list split 1;
#X obj 50 110 t b a;
#X obj 62 210 s;
#X obj 122 172 symbol;
#X obj 34 146 list;
#X obj 34 167 list trim;
#X floatatom 539 242 5 0 0 0 - - -, f 5;
#X floatatom 599 242 5 0 0 0 - - -, f 5;
#X obj 539 220 unpack f f;
#X floatatom 709 242 5 0 0 0 - - -, f 5;
#X floatatom 769 242 5 0 0 0 - - -, f 5;
#X obj 709 220 unpack f f;
#X obj 349 118 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 209 -44 loadbang;
#X obj 122 148 makefilename \$0-streamstretch-%s;
#X obj 349 88 r \$0-streamstretch-buffer-rec-switch;
#X obj 349 228 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 539 88 r \$0-streamstretch-window-size;
#X floatatom 539 110 5 0 0 0 - - -, f 5;
#X obj 539 198 r \$0-streamstretch-speed-range;
#X obj 709 198 r \$0-streamstretch-transpo-range;
#X floatatom 709 110 5 0 0 0 - - -, f 5;
#X obj 349 198 r \$0-streamstretch-auto-trig-switch;
#X floatatom 349 300 5 0 0 0 - - -, f 5;
#X obj 349 278 r \$0-streamstretch-auto-trig-rate;
#X obj 709 88 r \$0-streamstretch-auto-trig-prob;
#X msg 209 -14 buffer-rec-switch 0 \, trig-play-switch 0 \, window-size
2048 \, auto-trig-prob 70 \, auto-trig-rate 500 \, speed-range 70 90
\, transpo-range 0 0 \;;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 5 1;
#X connect 2 0 5 0;
#X connect 2 1 15 0;
#X connect 4 0 3 1;
#X connect 5 0 6 0;
#X connect 6 0 3 0;
#X connect 9 0 7 0;
#X connect 9 1 8 0;
#X connect 12 0 10 0;
#X connect 12 1 11 0;
#X connect 14 0 27 0;
#X connect 15 0 4 0;
#X connect 16 0 13 0;
#X connect 18 0 19 0;
#X connect 20 0 9 0;
#X connect 21 0 12 0;
#X connect 23 0 17 0;
#X connect 25 0 24 0;
#X connect 26 0 22 0;
#X connect 27 0 1 0;
#X restore 439 48 pd command-parsing;
#X connect 0 0 1 0;
#X connect 4 0 5 0;
#X connect 7 0 8 0;
